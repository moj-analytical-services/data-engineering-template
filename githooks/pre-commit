#!/bin/sh
#

# run Black and flake8 on all .py files in the repo
echo -e "\e[1mbold\e[0m"
printf "\n\e[1mRunning Black Python code formatter\e[0m\n"
black .
printf "\nRunning flake8 Python linter\n"
flake8 .
printf "\nRunning yamllint .yaml linter\n"
yamllint .

printf "\nRunning git-crypt status and checking for warnings\n"
# git-crypt check for unencrypted file warnings adapted from https://www.gitmemory.com/issue/AGWA/git-crypt/45/614607121
if [ -d ".git-crypt" ]; then
    git-crypt status | grep "\*\*\* WARNING"; test $? -eq 1
fi
